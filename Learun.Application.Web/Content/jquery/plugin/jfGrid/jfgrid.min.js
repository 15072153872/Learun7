(function(e){function y(b,a){e.each(b,function(b,d){b={label:d.label,name:d.name};a.push(b);d.children&&(b.children=[],y(d.children,b.children))})}e.jfGrid=e.jfGrid||{};e.extend(e.jfGrid,{render:function(b){var a=b[0].dfop;b.html("");b.addClass("jfgrid-layout");e.jfGrid.renderHead(b);e.jfGrid.renderBorder(b);e.jfGrid.renderLeft(b);e.jfGrid.renderScorllArea(b);e.jfGrid.renderPageBarinit(b);e.jfGrid.renderFooterrow(b);e.jfGrid.renderToolBar(b);b.append('<div class="jfgrid-move-line" id="jfgrid_move_line_'+
b[0].dfop.id+'"  ></div>');b.append('<div class="jfgrid-nodata-img" id="jfgrid_nodata_img_'+b[0].dfop.id+'"  ></div>');b.append('<div class="jfgrid-loading" id="jfgrid_loading_'+b[0].dfop.id+'"  ><div class="bg"></div><div class="img">\u6b63\u5728\u62fc\u547d\u52a0\u8f7d\u5217\u8868\u6570\u636e\u2026</div></div>');b.on("mousedown",e.jfGrid.bindmdown);b.on("click",e.jfGrid.bindClick);b.mousemove(e.jfGrid.bindmmove);b.on("mouseover",e.jfGrid.bindmover);a.rowdatas&&!a.url&&(a.isEidt&&0==a.rowdatas.length&&
a.rowdatas.push({}),e.jfGrid.renderData(b));b.css({"min-height":a.minheight});0<a.height&&b.css({height:a.height})},renderHead:function(b){var a=b[0].dfop;a._headWidth=0;a._leftWidth=0;a._headHeight=0;a._colModel=[];a._colFrozenModel=[];for(var c=e('<div class="jfgrid-head" id="jfgrid_head_'+a.id+'" ></div>'),d=e('<div class="jfgrid-border" id="jfgrid_border_'+a.id+'" ></div>'),f=e('<div class="jfgrid-border-col" id="jfgrid_border_col_'+a.id+'" ></div>'),h=a.headData.length,k=0;k<h;k++){var g=a.headData[k],
n=g.frozen?a._leftWidth:a._headWidth;g.height=28;var l=e('<div class="jfgrid-head-cell jfgrid-heed-rownum_0" path="'+k+'" >'+(g.label||"")+"</div>");g.obj=l;g.path=k;g.children?g.frozen?e.jfGrid.renderSubHead(f,g,a,a._leftWidth,1,!0,k):e.jfGrid.renderSubHead(c,g,a,a._headWidth,1,!1,k):(l.attr("jfgrid-heed-cellrender","ok"),l.append('<div class="jfgrid-heed-sort"><i class="fa fa-caret-up"></i><i class="fa fa-caret-down"></i></div>'),l.append('<div class="jfgrid-heed-move"></div>'),g.frozen?a._colFrozenModel[a._colFrozenModel.length]=
g:a._colModel[a._colModel.length]=g,g.type="datacol");g.left=n;l.css({width:(g.width||100)+"px","text-align":g.align||"left",left:n+"px"});a._headHeight=a._headHeight>g.height?a._headHeight:g.height;g.frozen?(a._leftWidth+=g.width,f.append(l)):(a._headWidth+=g.width,c.append(l))}if(28<a._headHeight)for(c.find('.jfgrid-heed-rownum_0[jfgrid-heed-cellrender="ok"]').css({height:a._headHeight+"px","line-height":a._headHeight-1+"px"}),f.find('.jfgrid-heed-rownum_0[jfgrid-heed-cellrender="ok"]').css({height:a._headHeight+
"px","line-height":a._headHeight-1+"px"}),k=0;k<h;k++)g=a.headData[k],g.children&&g.height<a._headHeight&&(g.children?e.jfGrid.renderSubHeadToo(g.children,a._headHeight-g.height):g.obj.css({height:a._headHeight-g.height+28+"px","line-height":a._headHeight-g.height+27+"px"}));d.append(f);b.append(d);b.append(c)},renderSubHead:function(b,a,c,d,f,h,k){a.width=0;for(var g=a.children,n=g.length,l=28,p=0;p<n;p++){var m=g[p];m.height=28;m.parent=a;var q=e('<div class="jfgrid-head-cell jfgrid-heed-rownum_'+
f+'" path="'+k+"."+p+'" >'+(m.label||"")+"</div>");m.obj=q;m.path=p;m.children?e.jfGrid.renderSubHead(b,m,c,d+a.width,f+1,h,k+"."+p):(q.attr("jfgrid-heed-cellrender","ok"),q.append('<div class="jfgrid-heed-sort"><i class="fa fa-caret-up"></i><i class="fa fa-caret-down"></i></div>'),q.append('<div class="jfgrid-heed-move"></div>'),h?(m.frozen=!0,c._colFrozenModel[c._colFrozenModel.length]=m):c._colModel[c._colModel.length]=m,m.type="datacol");m.left=d+a.width;q.css({width:(m.width||100)+"px","text-align":m.align||
d,left:d+a.width+"px",top:28*f+"px"});a.width+=m.width;l=m.height>l?m.height:l;b.append(q)}28<l&&b.find(".jfgrid-heed-rownum_"+f+'[jfgrid-heed-cellrender="ok"]').css({height:l+"px","line-height":l-1+"px"});a.height+=l},renderSubHeadToo:function(b,a){for(var c=b.length,d=0;d<c;d++){var f=b[d].obj;b[d].children?e.jfGrid.renderSubHeadToo(b[d].children,a):f.css({height:a+b[d].height+"px","line-height":b[d].height+a-1+"px"})}},renderBorder:function(b){var a=b[0].dfop,c=b.find("#jfgrid_border_"+a.id),d=
b.find("#jfgrid_head_"+a.id),f=0;if(a.isShowNum){var h=e('<div class="jfgrid-border-cell jfgrid-border-num"></div>');c.prepend(h);f+=30}a.isMultiselect&&(h=e('<div class="jfgrid-border-cell jfgrid-border-cb"><input role="checkbox" id="jfgrid_all_cb_'+a.id+'" type="checkbox"></div>').css("left",f+"px").css("line-height",a._headHeight-1+"px"),c.prepend(h),f+=30);a.isSubGrid&&(h=e('<div class="jfgrid-border-cell jfgrid-border-sub"></div>').css("left",f+"px"),c.prepend(h),f+=30);a._borderLeftPadding=
f;a._leftWidth+=f;c.css({width:a._leftWidth+"px",height:a._headHeight+"px","padding-left":f+"px"});d.css({width:a._headWidth+"px",height:a._headHeight+"px",left:a._leftWidth+"px"});b.css({"padding-left":a._leftWidth+"px","padding-top":a._headHeight+"px"})},renderLeft:function(b){var a=b[0].dfop,c=e('<div class="jfgrid-left" id="jfgrid_left_'+a.id+'" ></div>');c.css({width:a._leftWidth+"px",top:a._headHeight+"px"});b.append(c)},renderScorllArea:function(b){var a=b[0].dfop,c=e('<div class="jfgrid-scrollarea" id="jfgrid_scrollarea_'+
a.id+'" ><div class="jfgrid-scrollarea-content" id="jfgrid_scrollarea_content_'+a.id+'"  style="width:'+a._headWidth+'px;" ></div></div>');b.append(c);c.mCustomScrollbar({axis:"xy",setLeft:0,callbacks:{whileScrolling:function(){var a=e(this.mcs.content)[0].jfGridDfop;a&&(e("#jfgrid_left_"+a.id).css("top",a._headHeight+this.mcs.top+"px"),e("#jfgrid_head_"+a.id).css("left",a._leftWidth+this.mcs.left+"px"),e("#jfgrid_statistics_"+a.id).css("left",a._leftWidth+this.mcs.left+"px"))},onOverflowYNone:function(a){this.mcs&&
(a=e(this.mcs.content)[0].jfGridDfop,e("#jfgrid_left_"+a.id).css("top",a._headHeight+"px"))},onOverflowXNone:function(a){this.mcs&&(a=e(this.mcs.content)[0].jfGridDfop,e("#jfgrid_head_"+a.id).css("left",a._leftWidth+"px"),e("#jfgrid_statistics_"+a.id).css("left",a._leftWidth+"px"))},onUpdate:function(){if(this.mcs){var a=e(this.mcs.content)[0].jfGridDfop;e("#jfgrid_scrollarea_"+a.id).mCustomScrollbar("scrollTo","left",{scrollInertia:0,timeout:0})}}}});c.find("#jfgrid_scrollarea_content_"+a.id).parent()[0].jfGridDfop=
a;a=null},renderPageBarinit:function(b){var a=b[0].dfop;if(a.isPage&&a.url){b.css({"padding-bottom":"35px"});var c=e('<div class="jfgrid-page-bar" id="jfgrid_page_bar_'+a.id+'"><div class="jfgrid-page-bar-info" >\u65e0\u663e\u793a\u6570\u636e</div>\r\n                <div class="paginations" id="jfgrid_page_bar_nums_'+a.id+'" style="display:none;" >\r\n                <ul class="pagination pagination-sm"><li><a href="javascript:void(0);" class="pagebtn">\u9996\u9875</a></li></ul>\r\n                <ul class="pagination pagination-sm"><li><a href="javascript:void(0);" class="pagebtn">\u4e0a\u4e00\u9875</a></li></ul>\r\n                <ul class="pagination pagination-sm" id="jfgrid_page_bar_num_'+
a.id+'" ></ul>\r\n                <ul class="pagination pagination-sm"><li><a href="javascript:void(0);" class="pagebtn">\u4e0b\u4e00\u9875</a></li></ul>\r\n                <ul class="pagination pagination-sm"><li><a href="javascript:void(0);" class="pagebtn">\u5c3e\u9875</a></li></ul>\r\n                <ul class="pagination"><li><span></span></li></ul>\r\n                <ul class="pagination"><li><input type="text" class="form-control"></li></ul>\r\n                <ul class="pagination pagination-sm"><li><a href="javascript:void(0);" class="pagebtn">\u8df3\u8f6c</a></li></ul>\r\n                </div></div>');
b.append(c);c.find("#jfgrid_page_bar_num_"+a.id).on("click",e.jfGrid.reloadPage);e("#jfgrid_page_bar_nums_"+a.id+" .pagebtn").on("click",{op:a},e.jfGrid.reloadPage2)}},renderPageBar:function(b){var a=b[0].dfop;b=e("#jfgrid_page_bar_"+a.id);var c=b.find("#jfgrid_page_bar_num_"+a.id),d=b.find("#jfgrid_page_bar_nums_"+a.id),f="";if(0==a.rowdatas.length)a="\u65e0\u663e\u793a\u6570\u636e";else{var h=a.pageparam,k=(h.page-1)*h.rows+1,a="\u663e\u793a\u7b2c "+k+" - "+(k+a.rowdatas.length-1)+" \u6761\u8bb0\u5f55  <span>|</span> \u68c0\u7d22\u5230 "+
h.records+" \u6761\u8bb0\u5f55";if(1<h.total){var g=h.page-6,g=0>g?0:g,k=g+10;k>h.total&&(k=h.total);10>k-g&&(g=k-10);for(g=0>g?0:g;g<k;g++)f+='<li><a href="javascript:void(0);" class=" pagebtn '+(g+1==h.page?"active":"")+'" >'+(g+1)+"</a></li>";d.find("span").text("\u5171"+h.total+"\u9875,\u5230");d.show()}else d.hide()}c.html(f);b.find(".jfgrid-page-bar-info").html(a)},renderFooterrow:function(b){var a=b[0].dfop;a.footerrow&&!a.isPage&&(b.css({"padding-bottom":"29px"}),a=e('<div class="jfgrid-footerrow" id="jfgrid_footerrow_'+
a.id+'"></div>'),b.append(a))},renderToolBar:function(b){var a=b[0].dfop;if(a.isEidt){var c=e('<div class="jfgrid-toolbar" id="jfgrid_toolbar_'+a.id+'"></div>'),d=e('<span><i class="fa fa-plus"></i></span>'),f=e('<span><i class="fa fa-minus"></i></span>');d.on("click",function(){a.rowdatas.push({});e.jfGrid.renderData(b)});f.on("click",function(){var c={},d=!1;b.find(".jfgrid_selected_"+a.id+"[datapath]").each(function(){var a=e(this).attr("datapath");c[a]="1";d=!0});if(d){for(var g=[],f=0,l=a.rowdatas.length;f<
l;f++)c[f]||g.push(a.rowdatas[f]);0==g.length&&g.push({});a.rowdatas=g;e.jfGrid.renderData(b)}else top.learun.alert.warning("\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u884c!")});c.append(d);c.append(f);b.append(c)}},renderStatistics:function(b){var a=b[0].dfop;if(a.isStatistics){var c=b.find("#jfgrid_footerrow_"+a.id);b=c.find("#jfgrid_statistics_"+a.id);0==b.length&&(b=e('<div class="jfgrid-statistics" id="jfgrid_statistics_'+a.id+'" ></div>'),c.append(b),b.css({width:a._headWidth+"px",left:a._leftWidth+
"px"}));b.html("");for(var c=-1,d,f=0,h=a._colModel.length;f<h;f++){var k=a._colModel[f],g=0;if(k.statistics){-1==c&&(c=0,d&&d.html("\u5408\u8ba1:"));d=0;for(var n=a.rowdatas.length;d<n;d++){var l=a.rowdatas[d];void 0!=l[k.name]&&null!=l[k.name]&&""!=l[k.name]&&(g+=parseFloat(l[k.name]))}}d=e('<div class="jfgrid-data-cell"  colname="'+k.name+'" style="width:'+k.width+"px;text-align:"+k.align+';" ></div>');k.statistics&&(d.html(g),d.attr("title",k.label));b.append(d)}}},renderStatisticsOne:function(b,
a){var c=b[0].dfop;if(c.isStatistics){b=b.find("#jfgrid_statistics_"+c.id);for(var d=0,e=0,h=c.rowdatas.length;e<h;e++){var k=c.rowdatas[e];void 0!=k[a]&&null!=k[a]&&""!=k[a]&&(d+=parseFloat(k[a]))}b.find('[colname="'+a+'"]').html(d)}},reload:function(b){var a=b[0].dfop;a.rowdatas=[];a.isPage?(a.pageparam.page=a.pageparam.page||1,a.pageparam.records=0,a.pageparam.total=0,a.param.pagination=JSON.stringify(a.pageparam),e.jfGrid.ajaxLoad(b,a.url,a.param,function(c){200==c.code?(a.rowdatas=c.data.rows,
a.pageparam.page=c.data.page,a.pageparam.records=c.data.records,a.pageparam.total=c.data.total):(a.rowdatas=[],a.pageparam.page=1,a.pageparam.records=0,a.pageparam.total=0);e.jfGrid.renderData(b);if(a.onRenderComplete)a.onRenderComplete(c.data.rows)})):e.jfGrid.ajaxLoad(b,a.url,a.param,function(c){a.rowdatas=200==c.code?c.data:[];e.jfGrid.renderData(b);if(a.onRenderComplete)a.onRenderComplete(a.rowdatas)})},reloadPage:function(b){var a=e(this),c=e("#"+a.attr("id").replace("jfgrid_page_bar_num_","")),
d=c[0].dfop;b=e(b.target||b.srcElement);if(b.hasClass("pagebtn")){var f=parseInt(b.text());f!=d.pageparam.page&&(a.find(".active").removeClass("active"),b.addClass("active"),d.pageparam.page=f,d.param.pagination=JSON.stringify(d.pageparam),e.jfGrid.ajaxLoad(c,d.url,d.param,function(a){200==a.code&&(d.rowdatas=a.data.rows,d.pageparam.page=a.data.page,d.pageparam.records=a.data.records,d.pageparam.total=a.data.total);e.jfGrid.renderData(c)}))}},reloadPage2:function(b){var a=e(this),c=b.data.op,d=a.text();
b=e("#jfgrid_page_bar_num_"+c.id);var f=parseInt(b.find(".active").text());b=!1;switch(d){case "\u9996\u9875":1!=f&&(c.pageparam.page=1,b=!0);break;case "\u4e0a\u4e00\u9875":1<f&&(c.pageparam.page=f-1,b=!0);break;case "\u4e0b\u4e00\u9875":f<c.pageparam.total&&(c.pageparam.page=f+1,b=!0);break;case "\u5c3e\u9875":f!=c.pageparam.total&&(c.pageparam.page=c.pageparam.total,b=!0);break;case "\u8df3\u8f6c":if(a=a.parents("#jfgrid_page_bar_nums_"+c.id).find("input").val())a=parseInt(a),"NaN"!=String(a)&&
(1>a&&(a=1),a>c.pageparam.total&&(a=c.pageparam.total),c.pageparam.page=a,b=!0)}b&&(c.param.pagination=JSON.stringify(c.pageparam),e.jfGrid.ajaxLoad(e("#"+c.id),c.url,c.param,function(a){200==a.code&&(c.rowdatas=a.data.rows,c.pageparam.page=a.data.page,c.pageparam.records=a.data.records,c.pageparam.total=a.data.total);e.jfGrid.renderData(e("#"+c.id))}))},renderData:function(b){var a=b[0].dfop;a.isPage?(e.jfGrid.renderRowData(b,a.rowdatas),e.jfGrid.renderPageBar(b)):a.isTree?("tree"!=a.datatype&&(a.rowdatas=
e.jfGrid.listTotree(a.rowdatas,a.parentId,a.mainId,a)),e.jfGrid.renderTreeRowData(b,a.rowdatas)):e.jfGrid.renderRowData(b,a.rowdatas);e.jfGrid.renderStatistics(b)},renderRowData:function(b,a){var c=b[0].dfop,d=b.find("#jfgrid_left_"+c.id),f=b.find("#jfgrid_scrollarea_content_"+c.id),h=b.find("#jfgrid_nodata_img_"+c.id);h.hide();var k;c.reloadSelected&&!c.isMultiselect&&(k=e.jfGrid.getSelectedRow(b));d.html("");f.html("");a=a||[];for(var g=a.length,n=0;n<g;n++){var l=a[n],p=null,m="rownum_"+c.id+"_"+
n;d.append('<div class="jfgrid-data-cell jfgrid-hide-cell" rownum="'+m+'"  datapath="'+n+'" ></div>');if(c.isShowNum){var q=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+m+'" colname="jfgrid_rownum"  >'+(n+1)+"</div>");d.append(q);p=q}c.isMultiselect&&(q=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+m+'" colname="jfgrid_multiselect" ><input role="checkbox" type="checkbox" ></div>'),d.append(q),p=q);c.isSubGrid&&(q=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+
m+'" colname="jfgrid_subGrid"><i class="fa fa-plus jfgrid_expend" rownum="'+m+'" ></i></div>'),d.append(q),p=q);for(var w=0,u=c._colFrozenModel.length;w<u;w++)q=e('<div class="jfgrid-data-cell" rownum="'+m+'"  colname="'+c._colFrozenModel[w].name+'" style="width:'+c._colFrozenModel[w].width+"px;text-align:"+c._colFrozenModel[w].align+';"  title="'+(l[c._colFrozenModel[w].name]||"")+'" ></div>'),w==u-1&&(p=q),e.jfGrid.getCellHtml(c._colFrozenModel[w],l,c,q,n),d.append(q);p&&p.addClass("jfgrid-data-cell-last");
p=0;for(w=c._colModel.length;p<w;p++)q=e('<div class="jfgrid-data-cell" rownum="'+m+'" colname="'+c._colModel[p].name+'" style="width:'+c._colModel[p].width+"px;text-align:"+c._colModel[p].align+';" title="'+(l[c._colModel[p].name]||"")+'"  ></div>'),p==w-1&&q.addClass("jfgrid-data-cell-last"),e.jfGrid.getCellHtml(c._colModel[p],l,c,q,n),f.append(q);c.reloadSelected&&!c.isMultiselect&&k&&l[c.mainId]==k[c.mainId]&&b.find('.jfgrid-data-cell[rownum="'+m+'"]').addClass("jfgrid-head-cell-selected").addClass("jfgrid_selected_"+
c.id);c.multiselectfield&&1==parseInt(l[c.multiselectfield])&&b.find('.jfgrid-data-cell[rownum="'+m+'"][colname="jfgrid_multiselect"] input').trigger("click")}0==g?h.show():c.isAutoHeight&&(a=28*g,d=b.css("padding-top"),c.footerrow&&!c.isPage&&(a=parseInt(a)+29),b.css({height:parseInt(a)+parseInt(d)+2}))},renderTreeRowData:function(b,a){function c(a,k,m){for(var l=0,p=a.length;l<p;l++){var u=a[l],z=e('<div class="jfgrid-data-cell-expend" style="width:'+16*k+'px;" ></div>');u.jfgrid_rownum=n;var x=
"rownum_"+d.id+"_"+n,t=null;f.append('<div class="jfgrid-data-cell jfgrid-hide-cell"  rownum="'+x+'"  datapath="'+m+l+'" ></div>');if(d.isShowNum){var r=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+x+'" colname="jfgrid_rownum"  >'+(n+1)+"</div>");f.append(r);t=r}d.isMultiselect&&(r=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+x+'" colname="jfgrid_multiselect" ><input role="checkbox" type="checkbox" ></div>'),f.append(r),t=r);d.isSubGrid&&(r=e('<div class="jfgrid-data-cell jfgrid-tool-cell" rownum="'+
x+'" colname="jfgrid_subGrid"><i class="fa fa-plus jfgrid_expend" rownum="'+x+'" ></i></div>'),f.append(r),t=r);for(var v=0,y=d._colFrozenModel.length;v<y;v++)r=e('<div class="jfgrid-data-cell" rownum="'+x+'"  colname="'+d._colFrozenModel[v].name+'" style="width:'+d._colFrozenModel[v].width+"px;text-align:"+d._colFrozenModel[v].align+';"  title="'+(u[d._colFrozenModel[v].name]||"")+'" >'+(u[d._colFrozenModel[v].name]||"")+"</div>"),e.jfGrid.getCellHtml(d._colFrozenModel[v],u,d,r,l),0==v&&r.prepend(z),
v==y-1&&(t=r),f.append(r);t&&t.addClass("jfgrid-data-cell-last");t=0;for(v=d._colModel.length;t<v;t++)r=e('<div class="jfgrid-data-cell" rownum="'+x+'" colname="'+d._colModel[t].name+'" style="width:'+d._colModel[t].width+"px;text-align:"+d._colModel[t].align+';" title="'+(u[d._colModel[t].name]||"")+'"  >'+(u[d._colModel[t].name]||"")+"</div>"),e.jfGrid.getCellHtml(d._colModel[t],u,d,r,l),0==t&&0==d._colFrozenModel.length&&r.prepend(z),t==v-1&&r.addClass("jfgrid-data-cell-last"),h.append(r);d.reloadSelected&&
!d.isMultiselect&&g&&u[d.mainId]==g[d.mainId]&&b.find('.jfgrid-data-cell[rownum="'+x+'"]').addClass("jfgrid-head-cell-selected").addClass("jfgrid_selected_"+d.id);d.multiselectfield&&1==parseInt(u[d.multiselectfield])&&b.find('.jfgrid-data-cell[rownum="'+n+'"][colname="jfgrid_multiselect"] input').trigger("click");n++;0<u.jfGrid_ChildRows.length&&(z.append('<i class="fa fa-caret-down jfgrid-data-cell-expendi"></i>'),c(u.jfGrid_ChildRows,k+1,m+l+"."))}}var d=b[0].dfop,f=b.find("#jfgrid_left_"+d.id),
h=b.find("#jfgrid_scrollarea_content_"+d.id),k=b.find("#jfgrid_nodata_img_"+d.id),g;d.reloadSelected&&!d.isMultiselect&&(g=e.jfGrid.getSelectedRow(b));var n=0;k.hide();f.html("");h.html("");a=a||[];0<a.length?c(a,1,""):k.show();d=null},renderPage:function(b){e("#jfgrid_page_bar_"+b.id);b._pagination&&1<b._pagination.total&&(e('<li title="\u4e0a\u4e00\u9875" ><a href="#" aria-label="\u4e0a\u4e00\u9875"><span aria-hidden="true">&laquo;</span></a></li>'),e('<li title="\u4e0b\u4e00\u9875"><a href="#" aria-label="\u4e0b\u4e00\u9875"><span aria-hidden="true">&raquo;</span></a></li>'))},
getCellHtml:function(b,a,c,d,f){var h="",k=a[b.name];if(b.editType)switch(b.editType){case "input":h=e('<input  type="text" class="form-control" />').val(k||"");h.css({"text-align":b.align});h.on("input propertychange",function(){var d=e(this);a[b.name]=d.val();b.statistics&&e.jfGrid.renderStatisticsOne(e("#"+c.id),b.name);b.editOp&&b.editOp.callback&&(b.editOp.callback(f,a),e.jfGrid.renderData(e("#"+c.id)),e('[rownum="rownum_'+c.id+"_"+f+'"][colname="'+b.name+'"]>input').focus())});d.html(h);b.formatter&&
b.formatter(k,a,c,d);break;case "label":h=e('<span class="form-label" >'+(k||"")+"</span>");h.css({"text-align":b.align});d.html(h);break;case "select":h=e('<div class="form-select" >'+(k||"")+'<i class="fa fa-ellipsis-h"></i></div>');h.css({"text-align":b.align});h.find(".fa-ellipsis-h")[0]._node=b;h.find(".fa-ellipsis-h").on("click",function(){var b=e(this)[0]._node;e.jfGrid.layer({html:'<div class="jfgird-select"><div class="jfgird-select-tool"><div class="jfgird-select-tool-item"><input id="jfgird_select_keyword" style="width:200px;" type="text" class="form-control" placeholder="\u8bf7\u8f93\u5165\u8981\u67e5\u8be2\u5173\u952e\u5b57"></div><div class="jfgird-select-tool-item"><a id="jfgird_select_search" class="btn btn-primary btn-sm"><i class="fa fa-search"></i>&nbsp;\u67e5\u8be2</a></div></div><div id="jfgird_select"></div></div>',
width:b.editOp.width||400,height:b.editOp.height||400},function(d){d.find("#jfgird_select").jfGrid({headData:b.editOp.colData,url:b.editOp.url,onRenderComplete:function(a){b.editOp.rowdatas=a},onSelectRow:function(g){b.editOp.callback&&b.editOp.callback(g,f,a,b.editOp.selectData);d.remove();e.jfGrid.renderData(e("#"+c.id))}});b.editOp.rowdatas?d.find("#jfgird_select").jfGridSet("refreshdata",{rowdatas:b.editOp.rowdatas}):d.find("#jfgird_select").jfGridSet("reload",{param:b.editOp.param});e("#jfgird_select_search").on("click",
function(){var a=[],c=e("#jfgird_select_keyword").val();if(c){for(var d=0,f=b.editOp.rowdatas.length;d<f;d++)for(var g=b.editOp.rowdatas[d],h=0,k=b.editOp.colData.length;h<k;h++)if(-1!=g[b.editOp.colData[h].name].indexOf(c)){a.push(g);break}e("#jfgird_select").jfGridSet("refreshdata",{rowdatas:a})}else e("#jfgird_select").jfGridSet("refreshdata",{rowdatas:b.editOp.rowdatas})})})});d.html(h);break;case "checkbox":h=e('<div style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;background: #fff;" ><input  type="checkbox" style="margin:0;margin-top:7px;" /></div>');
1!=k&&"1"!=k||h.find("input").trigger("click");h.find("input").on("click",function(){e(this).is(":checked")?a[b.name]=1:a[b.name]=0});d.html(h);break;case "layerselect":h=e('<div class="form-select" >'+(k||"")+'<i class="fa fa-ellipsis-h"></i></div>'),h.css({"text-align":b.align}),h.find(".fa-ellipsis-h").on("click",function(){b.formatter(k,a,c,d)}),d.html(h)}else if(b.formatter)h=b.formatter(k,a,c,d),d.html(h);else if(b.formatterAsync)b.formatterAsync(function(a){d.html(a||"")},k,a,c,d);else{h=k;
if(null==k||void 0==k||"null"==k||"undefined"==k)h="";d.html(h)}},bindClick:function(b){var a=e(this),c=a[0].dfop,d=e(b.target||b.srcElement);c.isHeadWidhChange?(e.jfGrid.moveHeadWidth(c,!1),c.isHeadWidhChange=!1):d.hasClass("jfgrid-head-cell")?e.jfGrid.sortCol(d,c):d.hasClass("jfgrid_expend")&&d.parent().hasClass("jfgrid-data-cell")||d.hasClass("jfgrid-data-cell")&&0<d.find(".jfgrid_expend").length?e.jfGrid.expandSubGrid(d,c):d.hasClass("jfgrid-data-cell-expendi")?e.jfGrid.expandTree(d,c):d.hasClass("jfgrid-data-cell")||
0<d.parents(".jfgrid-data-cell").length?(e.jfGrid.selectRow(a,d,c),b.stopPropagation()):d.attr("id")=="jfgrid_all_cb_"+c.id&&e.jfGrid.selectAllRow(a,d,c)},bindmdown:function(b){var a=e(this)[0].dfop,c=e(b.target||b.srcElement);if(c.hasClass("jfgrid-heed-move")){var d=c.parent().attr("path"),c=e("#jfgrid_move_line_"+a.id);a._currentMoveCell=e.jfGrid.getHeadCell(d,a.headData);a._currentMoveCell.pageX=b.pageX;a._currentMoveLeft=0;a._currentMoveCell.frozen?a._currentMoveLeft=a._borderLeftPadding+a._currentMoveCell.left+
a._currentMoveCell.width:(b=parseInt(e("#jfgrid_head_"+a.id).css("left").replace(/px/g,"")),a._currentMoveLeft=b+a._currentMoveCell.left+a._currentMoveCell.width);a._currentMoveWidth=a._currentMoveCell.width;c.css("left",a._currentMoveLeft+"px");c.show();a.isHeadWidhChange=!0}},bindmmove:function(b){var a=e(this)[0].dfop;a.isHeadWidhChange&&e.jfGrid.moveHeadWidth(a,!0,b.pageX)},bindmover:function(b){var a=e(this);a.find(".jfgrid-data-cell-over").removeClass("jfgrid-data-cell-over");b=e(b.target||
b.srcElement);if(b.hasClass("jfgrid-data-cell")||0<b.parents(".jfgrid-data-cell").length){var c=b.attr("rownum");c||(c=b.parents(".jfgrid-data-cell").attr("rownum"));a.find('[rownum="'+c+'"]').addClass("jfgrid-data-cell-over")}},moveHeadWidth:function(b,a,c){var d=e("#jfgrid_move_line_"+b.id);a?(a=b._currentMoveCell.width+(c-b._currentMoveCell.pageX),a=40>a?40:a,c=b._currentMoveLeft+(a-b._currentMoveCell.width),b._currentMoveWidth=a,d.css("left",c+"px")):(b._currentMoveWidth!=b._currentMoveCell.width&&
(a=b._currentMoveWidth-b._currentMoveCell.width,b._currentMoveCell.width=b._currentMoveWidth,b._currentMoveCell.obj.css("width",b._currentMoveCell.width+"px"),c=b._currentMoveCell,e.jfGrid.refreshHead(c.frozen,b,b._currentMoveCell.parent,c,a)),d.hide())},getHeadCell:function(b,a){b=b.split(".");for(var c=0,d=b.length;c<d;c++){if(c==d-1)return a[b[c]];a=a[b[c]].children}},refreshHead:function(b,a,c,d,f){function h(a){for(var b=0,c=a.length;b<c;b++){var d=a[b];d.left+=f;d.obj.css("left",d.left+"px");
d.children&&h(d.children)}}for(;c;){d=d.path+1;for(var k=c.children.length;d<k;d++){var g=c.children[d];g.left+=f;g.obj.css("left",g.left+"px");g.children&&h(g.children)}c.width+=f;c.obj.css("width",c.width+"px");d=c;c=c.parent}d=d.path+1;for(k=a.headData.length;d<k;d++)g=a.headData[d],g.frozen==b&&(g.left+=f,g.obj.css("left",g.left+"px"),g.children&&h(g.children));c=e("#"+a.id);d=c.find("#jfgrid_head_"+a.id);b?(b=c.find("#jfgrid_border_"+a.id),k=c.find("#jfgrid_left_"+a.id),a._leftWidth+=f,c.css("padding-left",
a._leftWidth+"px"),b.css("width",a._leftWidth+"px"),k.css("width",a._leftWidth+"px"),d.css("left",a._leftWidth+"px")):(a._headWidth+=f,d.css("width",a._headWidth+"px"),b=c.find("#jfgrid_scrollarea_content_"+a.id),b.css("width",a._headWidth-10+"px"),0>f&&(c.css("width","10000px"),e("#jfgrid_scrollarea_"+a.id).mCustomScrollbar("update"),c.css("width","100%")),b.css("width",a._headWidth+"px"),e("#jfgrid_scrollarea_"+a.id).mCustomScrollbar("update"));c.find('.jfgrid-data-cell[colname="'+a._currentMoveCell.name+
'"]').css("width",a._currentMoveCell.width+"px")},selectRow:function(b,a,c){var d=a,f=a.attr("rownum");f||(d=a.parents(".jfgrid-data-cell"),f=d.attr("rownum"));var h=".jfgrid_selected_"+c.id;c.isMultiselect?"checkbox"==a.attr("role")&&(a=b.find('[rownum="'+f+'"][datapath]').attr("datapath"),a=e.jfGrid.getRowDataByPath(c,a),console.log(a[c.multiselectfield]),d.hasClass("jfgrid-head-cell-selected")?(b.find(h+'[rownum="'+f+'"]').removeClass("jfgrid-head-cell-selected").removeClass("jfgrid_selected_"+
c.id),e("#jfgrid_all_cb_"+c.id).is(":checked")&&(c._cancelallcb=!0,e("#jfgrid_all_cb_"+c.id).trigger("click")),c.multiselectfield&&(a[c.multiselectfield]=0),c.checkRow&&c.checkRow(a,!1)):(b.find('[rownum="'+f+'"]').addClass("jfgrid-head-cell-selected").addClass("jfgrid_selected_"+c.id),c.multiselectfield&&(a[c.multiselectfield]=1),c.checkRow&&c.checkRow(a,!0))):(b.find(h).removeClass("jfgrid-head-cell-selected").removeClass("jfgrid_selected_"+c.id),b.find('[rownum="'+f+'"]').addClass("jfgrid-head-cell-selected").addClass("jfgrid_selected_"+
c.id));if(c.onSelectRow)c.onSelectRow(e.jfGrid.getSelectedRow(b))},selectAllRow:function(b,a,c){a.is(":checked")?b.find('.jfgrid-tool-cell [role="checkbox"]').not(":checked").trigger("click"):(c._cancelallcb||b.find('.jfgrid-tool-cell [role="checkbox"]:checked').trigger("click"),c._cancelallcb=!1)},sortCol:function(b,a){b=b.attr("path");b=e.jfGrid.getHeadCell(b,a.headData);if("datacol"==b.type&&b.sort&&a.isPage){var c;a.sortcell?(a.sortcell.obj.find(".jfgrid-heed-sort").hide(),b==a.sortcell?(c=a.sortcell.obj.find(".jfgrid-heed-sort .active"),
c.removeClass("active"),c.hasClass("fa-caret-up")?(a.sortcell.obj.find(".jfgrid-heed-sort .fa-caret-down").addClass("active"),c=!1):(a.sortcell.obj.find(".jfgrid-heed-sort .fa-caret-up").addClass("active"),c=!0),a.sortcell.obj.find(".jfgrid-heed-sort").show()):(b.obj.find(".jfgrid-heed-sort .active").removeClass("active"),b.obj.find(".jfgrid-heed-sort .fa-caret-up").addClass("active"),b.obj.find(".jfgrid-heed-sort").show(),c=!0)):(b.obj.find(".jfgrid-heed-sort .active").removeClass("active"),b.obj.find(".jfgrid-heed-sort .fa-caret-up").addClass("active"),
b.obj.find(".jfgrid-heed-sort").show(),c=!0);a.sortcell=b;var d=e("#"+a.id);a.pageparam.sidx=b.name;a.pageparam.sord=c?"ASC":"DESC";e.jfGrid.reload(d)}},expandSubGrid:function(b,a){var c=b;b.hasClass("jfgrid_expend")||(c=b.find(".jfgrid_expend"));b=b.attr("rownum");var d=e("#jfgrid_scrollarea_content_"+a.id),f=e("#jfgrid_left_"+a.id),d=d.find('.jfgrid-data-cell-last[rownum="'+b+'"]'),f=f.find('.jfgrid-data-cell-last[rownum="'+b+'"]');if(0<f.next().find(".jfgrid_chlidgird").length)f.next().remove(),
d.next().remove(),c.removeClass("fa-minus"),c.addClass("fa-plus");else{c.removeClass("fa-plus");c.addClass("fa-minus");var c="jfgrid_chlidgird_content_"+a.id+"_"+b,h='<div class="jfgrid-subgird-cell" for-rownum="rowId" style="width:'+a._leftWidth+"px;height:"+a.subGridHeight+'px;" >',h=h+('<div class="jfgrid_chlidgird" style="width:'+(e("#jfgrid_scrollarea_"+a.id).width()+a._leftWidth)+"px;padding-left:"+a._borderLeftPadding+'px;" ><div class="jfgrid_subgird_left" style="width:'+a._borderLeftPadding+
'px;" ></div>');f.after(h+('<div class="jfgrid-chlidgird-content" id="'+c+'"></div>')+"</div></div>");d.after('<div class="jfgrid-data-cell" for-rownum="rowId" style="width:'+a._headWidth+"px;height:"+a.subGridHeight+'px;" ></div>');a.subGridRowExpanded&&(b=e("#"+a.id).find('.jfgrid-hide-cell[rownum="'+b+'"]').attr("datapath"),b=e.jfGrid.getRowDataByPath(a,b),a.subGridRowExpanded(c,b))}},expandTree:function(b,a){function c(a,b){for(var d=a[0].dfop,e=0,f=b.length;e<f;e++)a.find('[rownum="'+("rownum_"+
d.id+"_"+b[e].jfgrid_rownum)+'"]').not(".jfgrid-hide-cell").show(),0<b[e].jfGrid_ChildRows.length&&!b[e]._isclosed&&c(a,b[e].jfGrid_ChildRows)}function d(b,c){for(var e=0,f=c.length;e<f;e++)b.find('[rownum="'+("rownum_"+a.id+"_"+c[e].jfgrid_rownum)+'"]').hide(),0<c[e].jfGrid_ChildRows.length&&!c[e]._isclosed&&d(b,c[e].jfGrid_ChildRows)}var f=e("#"+a.id),h=b.parent().parent().attr("rownum"),h=f.find('.jfgrid-hide-cell[rownum="'+h+'"]').attr("datapath"),h=e.jfGrid.getRowDataByPath(a,h);b.hasClass("fa-caret-down")?
(h._isclosed=!0,d(f,h.jfGrid_ChildRows),b.removeClass("fa-caret-down"),b.addClass("fa-caret-right")):(h._isclosed=!1,c(f,h.jfGrid_ChildRows),b.removeClass("fa-caret-right"),b.addClass("fa-caret-down"))},listTotree:function(b,a,c,d){function e(a,b){b=k[b]||[];for(var f=0,h=b.length;f<h;f++){var g=b[f];g.jfGrid_ChildRows=[];e(g.jfGrid_ChildRows,g[c]);a.push(g);d._maprowdatas[g[c]]=g}}var h=[],k={},g={},n={};d._maprowdatas={};b=b||[];for(var l=0,p=b.length;l<p;l++){var m=b[l];g[m[c]]=1;k[m[a]]=k[m[a]]||
[];k[m[a]].push(m);1==g[m[a]]?delete n[m[a]]:n[m[a]]=1;1==n[m[c]]&&delete n[m[c]]}for(var q in n)e(h,q);return h},treeTolist:function(b){function a(b){for(var d=0,e=b.length;d<e;d++){var k={},g;for(g in b[d])"jfGrid_ChildRows"!=g&&(k[g]=b[d][g]);c.push(k);0<b[d].jfGrid_ChildRows.length&&a(b[d].jfGrid_ChildRows)}}var c=[];a(b);return c},getSelectedRow:function(b){var a=b[0].dfop,c,d=[];b.find(".jfgrid_selected_"+a.id+"[datapath]").each(function(){var b=e(this).attr("datapath");b&&(c=e.jfGrid.getRowDataByPath(a,
b),d.push(c))});return 1<d.length?d:c},getRowDataByPath:function(b,a){a=a.split(".");b=b.rowdatas;for(var c=null,d=0,e=a.length;d<e;d++){c=b[a[d]];if(!c)return null;b=c.jfGrid_ChildRows}return c},addTreeRow:function(b,a){var c=a.row;c.jfGrid_ChildRows=[];a.rowdatas=a.rowdatas||[];a._maprowdatas=a._maprowdatas||{};a._maprowdatas[c[a.parentId]]?a._maprowdatas[c[a.parentId]].jfGrid_ChildRows.push(c):a.rowdatas.push(c);a._maprowdatas[c[a.mainId]]=c;e.jfGrid.renderTreeRowData(b,a.rowdatas)},addRow:function(b,
a){a=b[0].dfop;a.rowdatas.push(a.row);e.jfGrid.renderRowData(b,a.rowdatas)},updateRow:function(b,a){var c=e.jfGrid.getSelectedRow(b);c&&(e.extend(c,a.row),!a.isPage&&a.isTree?e.jfGrid.renderTreeRowData(b,a.rowdatas):e.jfGrid.renderRowData(b,a.rowdatas))},removeRow:function(b,a){var c=e(b.find(".jfgrid-head-cell-selected[datapath]")[0]).attr("datapath");if(c){for(var c=c.split("."),d=a.rowdatas,f=0,h=c.length;f<h;f++)if(f==h-1){d.splice(c[f],1);break}else d=d[c[f]].jfGrid_ChildRows;!a.isPage&&a.isTree?
e.jfGrid.renderTreeRowData(b,a.rowdatas):e.jfGrid.renderRowData(b,a.rowdatas)}},layer:function(b,a){var c=e('<div class="jfgrid-layer"><div class="jfgrid-layer-bg"></div><div class="jfgrid-layer-content" style="width:'+b.width+"px;height:"+b.height+"px;margin:-"+b.height/2+"px 0 0 -"+b.width/2+'px;">'+b.html+'<span id="jfgridlayerremove" class="jfgrid-layer-remove"  title="\u5173\u95ed"><i class="fa fa-times"></i></span></div></div>');e("body").append(c);c.find("#jfgridlayerremove").on("click",function(){c.remove()});
a&&a(c)},loading:function(b,a){b=e("#jfgrid_loading_"+b[0].dfop.id);a?b.show():b.hide()},ajaxLoad:function(b,a,c,d){e.jfGrid.loading(b,!0);e.ajax({url:a,data:c,type:"GET",dataType:"json",async:!0,cache:!1,success:function(a){d(a);e.jfGrid.loading(b,!1)},error:function(a,b,c){d({code:500})},beforeSend:function(){},complete:function(){e.jfGrid.loading(b,!1)}})},print:function(b){function a(b,c){var d=b.length;e.each(b,function(b,g){f[c]=f[c]||e("<tr></tr>");b=e("<th>"+g.label+"</th>");if(g.children&&
0<g.children.length){var h=a(g.children,c+1);d=d+h-1;b.attr("colspan",h)}h=parseInt(g.obj.css("height"))/28;b.attr("rowspan",h);b.css("text-align",g.align);f[c].append(b)});return d}var c=b[0].dfop;console.log(c);var d=e('<table border="1" style=""></table>'),f=[];a(c.headData,0);e.each(f,function(a,b){d.append(b)});e.each(c.rowdatas,function(a,f){var g=e("<tr></tr>");b.find('[rownum="rownum_'+c.id+"_"+a+'"]').each(function(){var a=e(this),b=a.attr("colname");b&&"jfgrid_rownum"!=b&&"jfgrid_multiselect"!=
b&&"jfgrid_subGrid"!=b&&(b=e("<td>"+a.html()+"</td>"),b.css("text-align",a.css("text-align")),g.append(b))});d.append(g)});c=null;return d}});e.fn.jfGrid=function(b){var a=e(this);if(!a[0]||a[0].dfop)return a;var c=a.attr("id");if(null==c||void 0==c||""==c)c="jfgrid"+(new Date).getTime(),a.attr("id",c);var d={url:"",param:{},rowdatas:[],datatype:"array",headData:[],isShowNum:!0,isMultiselect:!1,multiselectfield:"",isSubGrid:!1,subGridRowExpanded:!1,subGridHeight:300,onSelectRow:!1,onRenderComplete:!1,
isPage:!1,pageparam:{rows:50,page:1,sidx:"",sord:"",records:0,total:0},sidx:"",sord:"ASC",isTree:!1,mainId:"id",parentId:"parentId",reloadSelected:!1,isAutoHeight:!1,footerrow:!1,isEidt:!1,minheight:0,height:0,isStatistics:!1};b&&e.extend(d,b);d.id=c;a[0].dfop=d;d.pageparam.sidx=d.sidx;d.pageparam.sord=d.sord;e.jfGrid.render(a);return a};e.fn.jfGridSet=function(b,a){var c=e(this),d=c.attr("id");if(null==d||void 0==d||""==d)return null;d=c[0].dfop;if(!d)return null;a&&e.extend(d,a);switch(b){case "reload":e.jfGrid.reload(c);
break;case "refreshdata":e.jfGrid.renderData(c);break;case "addRow":!d.isPage&&d.isTree?e.jfGrid.addTreeRow(c,d):e.jfGrid.addRow(c,d);break;case "updateRow":e.jfGrid.updateRow(c,d);break;case "removeRow":e.jfGrid.removeRow(c,d)}};e.fn.jfGridGet=function(b){var a=e(this),c=a.attr("id");if(null==c||void 0==c||""==c)return null;var d=a[0].dfop;if(!d)return null;switch(b){case "rowdata":return e.jfGrid.getSelectedRow(a);case "rowdatas":return d.rowdatas;case "rowdatasByArray":return e.jfGrid.treeTolist(d.rowdatas);
case "settingInfo":return d;case "headData":return b=[],y(d.headData,b),b;case "showData":var f=[];e.each(d.rowdatas,function(b,d){f[b]={};a.find('[rownum="rownum_'+c+"_"+b+'"]').each(function(){var a=e(this),c=a.attr("colname");c&&"jfgrid_rownum"!=c&&(f[b][c]=a.text())})});return f}d=null};e.fn.jfGridValue=function(b){var a=e(this),c=a.attr("id");if(null==c||void 0==c||""==c||!a[0].dfop)return null;if(a=e.jfGrid.getSelectedRow(a)){var d="";return 0<a.length?(e.each(a,function(a,c){""!=d&&(d+=",");
d+=c[b]||""}),d):a[b]||""}return""};e.fn.jfGridPrint=function(){var b=e(this);return e.jfGrid.print(b)}})(window.jQuery);